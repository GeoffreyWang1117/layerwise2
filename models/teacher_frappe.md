# Frappe-CTR DeepFM教师模型

## 1. 模型概述

### 1.1 Frappe数据集简介
Frappe数据集是移动应用推荐领域的基准数据集，包含用户-应用交互记录及其上下文特征（如时间、位置等）。适合开发上下文感知的推荐系统和CTR预测模型。

### 1.2 DeepFM架构简介
本模型基于DeepFM架构，结合了因子分解机(FM)和深度神经网络(DNN)的优势：

- **FM部分**: 高效捕获低阶特征交互
- **深度网络部分**: 学习高阶特征模式
- **线性部分**: 保留一阶特征影响

预测公式：
$$\hat{y} = \sigma(y_{linear} + y_{FM} + y_{DNN})$$

## 2. 关键特性与优化

### 2.1 特征工程优化
- **特征分析系统**: 智能分析特征分布，处理高基数特征
- **未知特征处理**: 基于频率统计的缺失值和未知值处理机制
- **统一嵌入维度**: 确保张量兼容性并优化内存使用

### 2.2 模型结构增强
- **三层神经网络**: (128, 64, 32)结构设计
- **批标准化**: 提高训练稳定性和收敛速度
- **多层正则化**: 结合L2正则化(系数1e-5)和Dropout(比率0.2)

### 2.3 模型训练策略
- **大批量训练**: 使用2048批次大小提高训练效率
- **注意力机制**: 自动捕获特征重要性
- **模型状态保存**: 完整保存特征映射与模型参数

## 3. 性能指标

在Frappe数据集上达到：
- **AUC**: 0.964 (业界优秀水平)
- **准确率**: 92.47%
- **F1分数**: 0.887

## 4. 知识蒸馏设计

特别设计用于知识蒸馏的组件：
- **中间层表示提取**: 获取特征嵌入和高级表示
- **嵌入参数导出**: 便于迁移知识到轻量级模型
- **概率输出校准**: 提供准确的软目标用于蒸馏

## 5. 应用场景

- 移动应用推荐系统
- 广告点击率预测
- 上下文感知的用户行为建模
- 作为知识蒸馏的教师模型